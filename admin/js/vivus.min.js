"use strict";!function(j,c){function h(a){if("undefined"==typeof a){throw new Error('Pathformer [constructor]: "element" parameter is required')}if(a.constructor===String&&(a=c.getElementById(a),!a)){throw new Error('Pathformer [constructor]: "element" parameter is not related to an existing ID')}if(!(a.constructor instanceof j.SVGElement||/^svg$/i.test(a.nodeName))){throw new Error('Pathformer [constructor]: "element" parameter must be a string or a SVGelement')}this.el=a,this.scan(a)}function f(k,a,i){this.isReady=!1,this.setElement(k,a),this.setOptions(a),this.setCallback(i),this.isReady&&this.init()}h.prototype.TYPES=["line","ellipse","circle","polygon","polyline","rect"],h.prototype.ATTR_WATCH=["cx","cy","points","r","rx","ry","x","x1","x2","y","y1","y2"],h.prototype.scan=function(u){for(var l,s,p,m,k=u.querySelectorAll(this.TYPES.join(",")),q=0;q<k.length;q++){s=k[q],l=this[s.tagName.toLowerCase()+"ToPath"],p=l(this.parseAttr(s.attributes)),m=this.pathMaker(s,p),s.parentNode.replaceChild(m,s)}},h.prototype.lineToPath=function(i){var a={};return a.d="M"+i.x1+","+i.y1+"L"+i.x2+","+i.y2,a},h.prototype.rectToPath=function(q){var l={},p=parseFloat(q.x)||0,o=parseFloat(q.y)||0,m=parseFloat(q.width)||0,k=parseFloat(q.height)||0;return l.d="M"+p+" "+o+" ",l.d+="L"+(p+m)+" "+o+" ",l.d+="L"+(p+m)+" "+(o+k)+" ",l.d+="L"+p+" "+(o+k)+" Z",l},h.prototype.polylineToPath=function(q){var l,p,o={},m=q.points.trim().split(" ");if(-1===q.points.indexOf(",")){var k=[];for(l=0;l<m.length;l+=2){k.push(m[l]+","+m[l+1])}m=k}for(p="M"+m[0],l=1;l<m.length;l++){-1!==m[l].indexOf(",")&&(p+="L"+m[l])}return o.d=p,o},h.prototype.polygonToPath=function(i){var a=h.prototype.polylineToPath(i);return a.d+="Z",a},h.prototype.ellipseToPath=function(q){var l=q.cx-q.rx,p=q.cy,o=parseFloat(q.cx)+parseFloat(q.rx),m=q.cy,k={};return k.d="M"+l+","+p+"A"+q.rx+","+q.ry+" 0,1,1 "+o+","+m+"A"+q.rx+","+q.ry+" 0,1,1 "+l+","+m,k},h.prototype.circleToPath=function(q){var l={},p=q.cx-q.r,o=q.cy,m=parseFloat(q.cx)+parseFloat(q.r),k=q.cy;return l.d="M"+p+","+o+"A"+q.r+","+q.r+" 0,1,1 "+m+","+k+"A"+q.r+","+q.r+" 0,1,1 "+p+","+k,l},h.prototype.pathMaker=function(o,m){var l,k,e=c.createElementNS("http://www.w3.org/2000/svg","path");for(l=0;l<o.attributes.length;l++){k=o.attributes[l],-1===this.ATTR_WATCH.indexOf(k.name)&&e.setAttribute(k.name,k.value)}for(l in m){e.setAttribute(l,m[l])}return e},h.prototype.parseAttr=function(l){for(var a,k={},i=0;i<l.length;i++){if(a=l[i],-1!==this.ATTR_WATCH.indexOf(a.name)&&-1!==a.value.indexOf("%")){throw new Error("Pathformer [parseAttr]: a SVG shape got values in percentage. This cannot be transformed into 'path' tags. Please use 'viewBox'.")}k[a.name]=a.value}return k};var d,b,g;f.LINEAR=function(a){return a},f.EASE=function(a){return -Math.cos(a*Math.PI)/2+0.5},f.EASE_OUT=function(a){return 1-Math.pow(1-a,3)},f.EASE_IN=function(a){return Math.pow(a,3)},f.EASE_OUT_BOUNCE=function(o){var a=-Math.cos(0.5*o*Math.PI)+1,m=Math.pow(a,1.5),l=Math.pow(1-o,2),k=-Math.abs(Math.cos(2.5*m*Math.PI))+1;return 1-l+k*l},f.prototype.setElement=function(p,l){if("undefined"==typeof p){throw new Error('Vivus [constructor]: "element" parameter is required')}if(p.constructor===String&&(p=c.getElementById(p),!p)){throw new Error('Vivus [constructor]: "element" parameter is not related to an existing ID')}if(this.parentEl=p,l&&l.file){var k=c.createElement("object");k.setAttribute("type","image/svg+xml"),k.setAttribute("data",l.file),k.setAttribute("built-by-vivus","true"),p.appendChild(k),p=k}switch(p.constructor){case j.SVGSVGElement:case j.SVGElement:this.el=p,this.isReady=!0;break;case j.HTMLObjectElement:var e,m;m=this,e=function(a){if(!m.isReady){if(m.el=p.contentDocument&&p.contentDocument.querySelector("svg"),!m.el&&a){throw new Error("Vivus [constructor]: object loaded does not contain any SVG")}return m.el?(p.getAttribute("built-by-vivus")&&(m.parentEl.insertBefore(m.el,p),m.parentEl.removeChild(p),m.el.setAttribute("width","100%"),m.el.setAttribute("height","100%")),m.isReady=!0,m.init(),!0):void 0}},e()||p.addEventListener("load",e);break;default:throw new Error('Vivus [constructor]: "element" parameter is not valid (or miss the "file" attribute)')}},f.prototype.setOptions=function(a){var l=["delayed","async","oneByOne","scenario","scenario-sync"],k=["inViewport","manual","autostart"];if(void 0!==a&&a.constructor!==Object){throw new Error('Vivus [constructor]: "options" parameter must be an object')}if(a=a||{},a.type&&-1===l.indexOf(a.type)){throw new Error("Vivus [constructor]: "+a.type+" is not an existing animation `type`")}if(this.type=a.type||l[0],a.start&&-1===k.indexOf(a.start)){throw new Error("Vivus [constructor]: "+a.start+" is not an existing `start` option")}if(this.start=a.start||k[0],this.isIE=-1!==j.navigator.userAgent.indexOf("MSIE")||-1!==j.navigator.userAgent.indexOf("Trident/")||-1!==j.navigator.userAgent.indexOf("Edge/"),this.duration=g(a.duration,120),this.delay=g(a.delay,null),this.dashGap=g(a.dashGap,1),this.forceRender=a.hasOwnProperty("forceRender")?!!a.forceRender:this.isIE,this.selfDestroy=!!a.selfDestroy,this.onReady=a.onReady,this.frameLength=this.currentFrame=this.map=this.delayUnit=this.speed=this.handle=null,this.ignoreInvisible=a.hasOwnProperty("ignoreInvisible")?!!a.ignoreInvisible:!1,this.animTimingFunction=a.animTimingFunction||f.LINEAR,this.pathTimingFunction=a.pathTimingFunction||f.LINEAR,this.delay>=this.duration){throw new Error("Vivus [constructor]: delay must be shorter than duration")}},f.prototype.setCallback=function(a){if(a&&a.constructor!==Function){throw new Error('Vivus [constructor]: "callback" parameter must be a function')}this.callback=a||function(){}},f.prototype.mapping=function(){var l,q,p,o,k,t,m,v;for(v=t=m=0,q=this.el.querySelectorAll("path"),l=0;l<q.length;l++){p=q[l],this.isInvisible(p)||(k={el:p,length:Math.ceil(p.getTotalLength())},isNaN(k.length)?j.console&&console.warn&&console.warn("Vivus [mapping]: cannot retrieve a path element length",p):(this.map.push(k),p.style.strokeDasharray=k.length+" "+(k.length+2*this.dashGap),p.style.strokeDashoffset=k.length+this.dashGap,k.length+=this.dashGap,t+=k.length,this.renderPath(l)))}for(t=0===t?1:t,this.delay=null===this.delay?this.duration/3:this.delay,this.delayUnit=this.delay/(q.length>1?q.length-1:1),l=0;l<this.map.length;l++){switch(k=this.map[l],this.type){case"delayed":k.startAt=this.delayUnit*l,k.duration=this.duration-this.delay;break;case"oneByOne":k.startAt=m/t*this.duration,k.duration=k.length/t*this.duration;break;case"async":k.startAt=0,k.duration=this.duration;break;case"scenario-sync":p=q[l],o=this.parseAttr(p),k.startAt=v+(g(o["data-delay"],this.delayUnit)||0),k.duration=g(o["data-duration"],this.duration),v=void 0!==o["data-async"]?k.startAt:k.startAt+k.duration,this.frameLength=Math.max(this.frameLength,k.startAt+k.duration);break;case"scenario":p=q[l],o=this.parseAttr(p),k.startAt=g(o["data-start"],this.delayUnit)||0,k.duration=g(o["data-duration"],this.duration),this.frameLength=Math.max(this.frameLength,k.startAt+k.duration)}m+=k.length,this.frameLength=this.frameLength||this.duration}},f.prototype.drawer=function(){var a=this;this.currentFrame+=this.speed,this.currentFrame<=0?(this.stop(),this.reset(),this.callback(this)):this.currentFrame>=this.frameLength?(this.stop(),this.currentFrame=this.frameLength,this.trace(),this.selfDestroy&&this.destroy(),this.callback(this)):(this.trace(),this.handle=d(function(){a.drawer()}))},f.prototype.trace=function(){var l,a,k,i;for(i=this.animTimingFunction(this.currentFrame/this.frameLength)*this.frameLength,l=0;l<this.map.length;l++){k=this.map[l],a=(i-k.startAt)/k.duration,a=this.pathTimingFunction(Math.max(0,Math.min(1,a))),k.progress!==a&&(k.progress=a,k.el.style.strokeDashoffset=Math.floor(k.length*(1-a)),this.renderPath(l))}},f.prototype.renderPath=function(k){if(this.forceRender&&this.map&&this.map[k]){var a=this.map[k],i=a.el.cloneNode(!0);a.el.parentNode.replaceChild(i,a.el),a.el=i}},f.prototype.init=function(){this.frameLength=0,this.currentFrame=0,this.map=[],new h(this.el),this.mapping(),this.starter(),this.onReady&&this.onReady(this)},f.prototype.starter=function(){switch(this.start){case"manual":return;case"autostart":this.play();break;case"inViewport":var a=this,i=function(){a.isInViewport(a.parentEl,1)&&(a.play(),j.removeEventListener("scroll",i))};j.addEventListener("scroll",i),i()}},f.prototype.getStatus=function(){return 0===this.currentFrame?"start":this.currentFrame===this.frameLength?"end":"progress"},f.prototype.reset=function(){return this.setFrameProgress(0)},f.prototype.finish=function(){return this.setFrameProgress(1)},f.prototype.setFrameProgress=function(a){return a=Math.min(1,Math.max(0,a)),this.currentFrame=Math.round(this.frameLength*a),this.trace(),this},f.prototype.play=function(a){if(a&&"number"!=typeof a){throw new Error("Vivus [play]: invalid speed")}return this.speed=a||1,this.handle||this.drawer(),this},f.prototype.stop=function(){return this.handle&&(b(this.handle),this.handle=null),this},f.prototype.destroy=function(){var i,a;for(i=0;i<this.map.length;i++){a=this.map[i],a.el.style.strokeDashoffset=null,a.el.style.strokeDasharray=null,this.renderPath(i)}},f.prototype.isInvisible=function(k){var a,i=k.getAttribute("data-ignore");return null!==i?"false"!==i:this.ignoreInvisible?(a=k.getBoundingClientRect(),!a.width&&!a.height):!1},f.prototype.parseAttr=function(l){var a,k={};if(l&&l.attributes){for(var i=0;i<l.attributes.length;i++){a=l.attributes[i],k[a.name]=a.value}}return k},f.prototype.isInViewport=function(w,l){var u=this.scrollY(),p=u+this.getViewportH(),m=w.getBoundingClientRect(),k=m.height,q=u+m.top,v=q+k;return l=l||0,p>=q+k*l&&v>=u},f.prototype.docElem=j.document.documentElement,f.prototype.getViewportH=function(){var a=this.docElem.clientHeight,i=j.innerHeight;return i>a?i:a},f.prototype.scrollY=function(){return j.pageYOffset||this.docElem.scrollTop},d=function(){return j.requestAnimationFrame||j.webkitRequestAnimationFrame||j.mozRequestAnimationFrame||j.oRequestAnimationFrame||j.msRequestAnimationFrame||function(a){return j.setTimeout(a,1000/60)}}(),b=function(){return j.cancelAnimationFrame||j.webkitCancelAnimationFrame||j.mozCancelAnimationFrame||j.oCancelAnimationFrame||j.msCancelAnimationFrame||function(a){return j.clearTimeout(a)}}(),g=function(k,a){var i=parseInt(k,10);return i>=0?i:a},"function"==typeof define&&define.amd?define([],function(){return f}):"object"==typeof exports?module.exports=f:j.Vivus=f}(window,document);;